var ye=Object.defineProperty;var ve=(e,t)=>{for(var r in t)ye(e,r,{get:t[r],enumerable:!0})};import*as b from"node:module";import{pathToFileURL as ut}from"node:url";var P={};ve(P,{DEBUG:()=>T});var T=Se(process.env.DEBUG);function Se(e){if(e===void 0)return!1;if(e==="true"||e==="1")return!0;if(e==="false"||e==="0")return!1;if(e==="*")return!0;let t=e.split(",").map(r=>r.split(":")[0]);return t.includes("-tailwindcss")?!1:!!t.includes("tailwindcss")}import A from"enhanced-resolve";import{createJiti as Ye}from"jiti";import B from"node:fs";import pe from"node:fs/promises";import M,{dirname as oe}from"node:path";import{pathToFileURL as ae}from"node:url";import{__unstable__loadDesignSystem as Xe,compile as Ze,compileAst as et,Features as tt}from"tailwindcss";import O from"node:fs/promises";import y from"node:path";var we=[/import[\s\S]*?['"](.{3,}?)['"]/gi,/import[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/export[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/require\(['"`](.+)['"`]\)/gi],Ne=[".js",".cjs",".mjs"],Ee=["",".js",".cjs",".mjs",".ts",".cts",".mts",".jsx",".tsx"],Ce=["",".ts",".cts",".mts",".tsx",".js",".cjs",".mjs",".jsx"];async function Re(e,t){for(let r of t){let s=`${e}${r}`;if((await O.stat(s).catch(()=>null))?.isFile())return s}for(let r of t){let s=`${e}/index${r}`;if(await O.access(s).then(()=>!0,()=>!1))return s}return null}async function z(e,t,r,s){let n=Ne.includes(s)?Ee:Ce,l=await Re(y.resolve(r,t),n);if(l===null||e.has(l))return;e.add(l),r=y.dirname(l),s=y.extname(l);let i=await O.readFile(l,"utf-8"),a=[];for(let o of we)for(let f of i.matchAll(o))f[1].startsWith(".")&&a.push(z(e,f[1],r,s));await Promise.all(a)}async function G(e){let t=new Set;return await z(t,e,y.dirname(e),y.extname(e)),Array.from(t)}import*as W from"node:path";var v=92,N=47,E=42,ke=34,$e=39,be=58,C=59,h=10,S=32,R=9,Q=123,D=125,F=40,q=41,_e=91,Te=93,J=45,U=64,Pe=33;function Y(e){e=e.replaceAll(`\r
`,`
`);let t=[],r=[],s=[],n=null,l=null,i="",a="",o;for(let f=0;f<e.length;f++){let u=e.charCodeAt(f);if(u===v)i+=e.slice(f,f+2),f+=1;else if(u===N&&e.charCodeAt(f+1)===E){let c=f;for(let m=f+2;m<e.length;m++)if(o=e.charCodeAt(m),o===v)m+=1;else if(o===E&&e.charCodeAt(m+1)===N){f=m+1;break}let p=e.slice(c,f+1);p.charCodeAt(2)===Pe&&r.push(ee(p.slice(2,-2)))}else if(u===$e||u===ke){let c=f;for(let p=f+1;p<e.length;p++)if(o=e.charCodeAt(p),o===v)p+=1;else if(o===u){f=p;break}else{if(o===C&&e.charCodeAt(p+1)===h)throw new Error(`Unterminated string: ${e.slice(c,p+1)+String.fromCharCode(u)}`);if(o===h)throw new Error(`Unterminated string: ${e.slice(c,p)+String.fromCharCode(u)}`)}i+=e.slice(c,f+1)}else{if((u===S||u===h||u===R)&&(o=e.charCodeAt(f+1))&&(o===S||o===h||o===R))continue;if(u===h){if(i.length===0)continue;o=i.charCodeAt(i.length-1),o!==S&&o!==h&&o!==R&&(i+=" ")}else if(u===J&&e.charCodeAt(f+1)===J&&i.length===0){let c="",p=f,m=-1;for(let d=f+2;d<e.length;d++)if(o=e.charCodeAt(d),o===v)d+=1;else if(o===N&&e.charCodeAt(d+1)===E){for(let g=d+2;g<e.length;g++)if(o=e.charCodeAt(g),o===v)g+=1;else if(o===E&&e.charCodeAt(g+1)===N){d=g+1;break}}else if(m===-1&&o===be)m=i.length+d-p;else if(o===C&&c.length===0){i+=e.slice(p,d),f=d;break}else if(o===F)c+=")";else if(o===_e)c+="]";else if(o===Q)c+="}";else if((o===D||e.length-1===d)&&c.length===0){f=d-1,i+=e.slice(p,d);break}else(o===q||o===Te||o===D)&&c.length>0&&e[d]===c[c.length-1]&&(c=c.slice(0,-1));let _=I(i,m);if(!_)throw new Error("Invalid custom property, expected a value");n?n.nodes.push(_):t.push(_),i=""}else if(u===C&&i.charCodeAt(0)===U)l=w(i),n?n.nodes.push(l):t.push(l),i="",l=null;else if(u===C&&a[a.length-1]!==")"){let c=I(i);if(!c)throw i.length===0?new Error("Unexpected semicolon"):new Error(`Invalid declaration: \`${i.trim()}\``);n?n.nodes.push(c):t.push(c),i=""}else if(u===Q&&a[a.length-1]!==")")a+="}",l=X(i.trim()),n&&n.nodes.push(l),s.push(n),n=l,i="",l=null;else if(u===D&&a[a.length-1]!==")"){if(a==="")throw new Error("Missing opening {");if(a=a.slice(0,-1),i.length>0)if(i.charCodeAt(0)===U)l=w(i),n?n.nodes.push(l):t.push(l),i="",l=null;else{let p=i.indexOf(":");if(n){let m=I(i,p);if(!m)throw new Error(`Invalid declaration: \`${i.trim()}\``);n.nodes.push(m)}}let c=s.pop()??null;c===null&&n&&t.push(n),n=c,i="",l=null}else if(u===F)a+=")",i+="(";else if(u===q){if(a[a.length-1]!==")")throw new Error("Missing opening (");a=a.slice(0,-1),i+=")"}else{if(i.length===0&&(u===S||u===h||u===R))continue;i+=String.fromCharCode(u)}}}if(i.charCodeAt(0)===U&&t.push(w(i)),a.length>0&&n){if(n.kind==="rule")throw new Error(`Missing closing } at ${n.selector}`);if(n.kind==="at-rule")throw new Error(`Missing closing } at ${n.name} ${n.params}`)}return r.length>0?r.concat(t):t}function w(e,t=[]){for(let r=5;r<e.length;r++){let s=e.charCodeAt(r);if(s===S||s===F){let n=e.slice(0,r).trim(),l=e.slice(r).trim();return V(n,l,t)}}return V(e.trim(),"",t)}function I(e,t=e.indexOf(":")){if(t===-1)return null;let r=e.indexOf("!important",t+1);return Z(e.slice(0,t).trim(),e.slice(t+1,r===-1?e.length:r).trim(),r!==-1)}var x=class extends Map{constructor(r){super();this.factory=r}get(r){let s=super.get(r);return s===void 0&&(s=this.factory(r,this),this.set(r,s)),s}};var De=64;function Ue(e,t=[]){return{kind:"rule",selector:e,nodes:t}}function V(e,t="",r=[]){return{kind:"at-rule",name:e,params:t,nodes:r}}function X(e,t=[]){return e.charCodeAt(0)===De?w(e,t):Ue(e,t)}function Z(e,t,r=!1){return{kind:"declaration",property:e,value:t,important:r}}function ee(e){return{kind:"comment",value:e}}function k(e,t,r=[],s={}){for(let n=0;n<e.length;n++){let l=e[n],i=r[r.length-1]??null;if(l.kind==="context"){if(k(l.nodes,t,r,{...s,...l.context})===2)return 2;continue}r.push(l);let a=!1,o=0,f=t(l,{parent:i,context:s,path:r,replaceWith(u){a=!0,Array.isArray(u)?u.length===0?(e.splice(n,1),o=0):u.length===1?(e[n]=u[0],o=1):(e.splice(n,1,...u),o=u.length):(e[n]=u,o=1)}})??0;if(r.pop(),a){f===0?n--:n+=o-1;continue}if(f===2)return 2;if(f!==1&&"nodes"in l){r.push(l);let u=k(l.nodes,t,r,s);if(r.pop(),u===2)return 2}}}function te(e){function t(s,n=0){let l="",i="  ".repeat(n);if(s.kind==="declaration")l+=`${i}${s.property}: ${s.value}${s.important?" !important":""};
`;else if(s.kind==="rule"){l+=`${i}${s.selector} {
`;for(let a of s.nodes)l+=t(a,n+1);l+=`${i}}
`}else if(s.kind==="at-rule"){if(s.nodes.length===0)return`${i}${s.name} ${s.params};
`;l+=`${i}${s.name}${s.params?` ${s.params} `:" "}{
`;for(let a of s.nodes)l+=t(a,n+1);l+=`${i}}
`}else if(s.kind==="comment")l+=`${i}/*${s.value}*/
`;else if(s.kind==="context"||s.kind==="at-root")return"";return l}let r="";for(let s of e){let n=t(s);n!==""&&(r+=n)}return r}function Ie(e,t){if(typeof e!="string")throw new TypeError("expected path to be a string");if(e==="\\"||e==="/")return"/";var r=e.length;if(r<=1)return e;var s="";if(r>4&&e[3]==="\\"){var n=e[2];(n==="?"||n===".")&&e.slice(0,2)==="\\\\"&&(e=e.slice(2),s="//")}var l=e.split(/[/\\]+/);return t!==!1&&l[l.length-1]===""&&l.pop(),s+l.join("/")}function L(e){let t=Ie(e);return e.startsWith("\\\\")&&t.startsWith("/")&&!t.startsWith("//")?`/${t}`:t}var K=/(?<!@import\s+)(?<=^|[^\w\-\u0080-\uffff])url\((\s*('[^']+'|"[^"]+")\s*|[^'")]+)\)/,re=/(?<=image-set\()((?:[\w-]{1,256}\([^)]*\)|[^)])*)(?=\))/,Fe=/(?:gradient|element|cross-fade|image)\(/,Ve=/^\s*data:/i,Le=/^([a-z]+:)?\/\//,We=/^[A-Z_][.\w-]*\(/i,Ke=/(?:^|\s)(?<url>[\w-]+\([^)]*\)|"[^"]*"|'[^']*'|[^,]\S*[^,])\s*(?:\s(?<descriptor>\w[^,]+))?(?:,|$)/g,Me=/(?<!\\)"/g,je=/(?: |\\t|\\n|\\f|\\r)+/g,Be=e=>Ve.test(e),He=e=>Le.test(e);async function se({css:e,base:t,root:r}){if(!e.includes("url(")&&!e.includes("image-set("))return e;let s=Y(e),n=[];function l(i){if(i[0]==="/")return i;let a=W.posix.join(L(t),i),o=W.posix.relative(L(r),a);return o.startsWith(".")||(o="./"+o),o}return k(s,i=>{if(i.kind!=="declaration"||!i.value)return;let a=K.test(i.value),o=re.test(i.value);if(a||o){let f=o?ze:ne;n.push(f(i.value,l).then(u=>{i.value=u}))}}),n.length&&await Promise.all(n),te(s)}function ne(e,t){return le(e,K,async r=>{let[s,n]=r;return await ie(n.trim(),s,t)})}async function ze(e,t){return await le(e,re,async r=>{let[,s]=r;return await Qe(s,async({url:l})=>K.test(l)?await ne(l,t):Fe.test(l)?l:await ie(l,l,t))})}async function ie(e,t,r,s="url"){let n="",l=e[0];if((l==='"'||l==="'")&&(n=l,e=e.slice(1,-1)),Ge(e))return t;let i=await r(e);return n===""&&i!==encodeURI(i)&&(n='"'),n==="'"&&i.includes("'")&&(n='"'),n==='"'&&i.includes('"')&&(i=i.replace(Me,'\\"')),`${s}(${n}${i}${n})`}function Ge(e,t){return He(e)||Be(e)||!e[0].match(/[\.a-zA-Z0-9_]/)||We.test(e)}function Qe(e,t){return Promise.all(qe(e).map(async({url:r,descriptor:s})=>({url:await t({url:r,descriptor:s}),descriptor:s}))).then(Je)}function qe(e){let t=e.trim().replace(je," ").replace(/\r?\n/,"").replace(/,\s+/,", ").replaceAll(/\s+/g," ").matchAll(Ke);return Array.from(t,({groups:r})=>({url:r?.url?.trim()??"",descriptor:r?.descriptor?.trim()??""})).filter(({url:r})=>!!r)}function Je(e){return e.map(({url:t,descriptor:r})=>t+(r?` ${r}`:"")).join(", ")}async function le(e,t,r){let s,n=e,l="";for(;s=t.exec(n);)l+=n.slice(0,s.index),l+=await r(s),n=n.slice(s.index+s[0].length);return l+=n,l}function de({base:e,onDependency:t,shouldRewriteUrls:r,customCssResolver:s,customJsResolver:n}){return{base:e,async loadModule(l,i){return he(l,i,t,n)},async loadStylesheet(l,i){let a=await ge(l,i,t,s);return r&&(a.content=await se({css:a.content,root:i,base:a.base})),a}}}async function me(e,t){if(e.root&&e.root!=="none"){let r=/[*{]/,s=[];for(let l of e.root.pattern.split("/")){if(r.test(l))break;s.push(l)}if(!await pe.stat(M.resolve(t,s.join("/"))).then(l=>l.isDirectory()).catch(()=>!1))throw new Error(`The \`source(${e.root.pattern})\` does not exist`)}}async function rt(e,t){let r=await et(e,de(t));return await me(r,t.base),r}async function st(e,t){let r=await Ze(e,de(t));return await me(r,t.base),r}async function nt(e,{base:t}){return Xe(e,{base:t,async loadModule(r,s){return he(r,s,()=>{})},async loadStylesheet(r,s){return ge(r,s,()=>{})}})}async function he(e,t,r,s){if(e[0]!=="."){let a=await ce(e,t,s);if(!a)throw new Error(`Could not resolve '${e}' from '${t}'`);let o=await fe(ae(a).href);return{base:oe(a),module:o.default??o}}let n=await ce(e,t,s);if(!n)throw new Error(`Could not resolve '${e}' from '${t}'`);let[l,i]=await Promise.all([fe(ae(n).href+"?id="+Date.now()),G(n)]);for(let a of i)r(a);return{base:oe(n),module:l.default??l}}async function ge(e,t,r,s){let n=await lt(e,t,s);if(!n)throw new Error(`Could not resolve '${e}' from '${t}'`);if(r(n),typeof globalThis.__tw_readFile=="function"){let i=await globalThis.__tw_readFile(n,"utf-8");if(i)return{base:M.dirname(n),content:i}}let l=await pe.readFile(n,"utf-8");return{base:M.dirname(n),content:l}}var ue=null;async function fe(e){if(typeof globalThis.__tw_load=="function"){let t=await globalThis.__tw_load(e);if(t)return t}try{return await import(e)}catch{return ue??=Ye(import.meta.url,{moduleCache:!1,fsCache:!1}),await ue.import(e)}}var H=["node_modules",...process.env.NODE_PATH?[process.env.NODE_PATH]:[]],it=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(B,4e3),useSyncFileSystemCalls:!0,extensions:[".css"],mainFields:["style"],conditionNames:["style"],modules:H});async function lt(e,t,r){if(typeof globalThis.__tw_resolve=="function"){let s=globalThis.__tw_resolve(e,t);if(s)return Promise.resolve(s)}if(r){let s=await r(e,t);if(s)return s}return j(it,e,t)}var ot=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(B,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","import"],modules:H}),at=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(B,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","require"],modules:H});async function ce(e,t,r){if(typeof globalThis.__tw_resolve=="function"){let s=globalThis.__tw_resolve(e,t);if(s)return Promise.resolve(s)}if(r){let s=await r(e,t);if(s)return s}return j(ot,e,t).catch(()=>j(at,e,t))}function j(e,t,r){return new Promise((s,n)=>e.resolve({},r,t,{},(l,i)=>{if(l)return n(l);s(i)}))}Symbol.dispose??=Symbol("Symbol.dispose");Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");var xe=class{constructor(t=r=>void process.stderr.write(`${r}
`)){this.defaultFlush=t}#r=new x(()=>({value:0}));#t=new x(()=>({value:0n}));#e=[];hit(t){this.#r.get(t).value++}start(t){let r=this.#e.map(n=>n.label).join("//"),s=`${r}${r.length===0?"":"//"}${t}`;this.#r.get(s).value++,this.#t.get(s),this.#e.push({id:s,label:t,namespace:r,value:process.hrtime.bigint()})}end(t){let r=process.hrtime.bigint();if(this.#e[this.#e.length-1].label!==t)throw new Error(`Mismatched timer label: \`${t}\`, expected \`${this.#e[this.#e.length-1].label}\``);let s=this.#e.pop(),n=r-s.value;this.#t.get(s.id).value+=n}reset(){this.#r.clear(),this.#t.clear(),this.#e.splice(0)}report(t=this.defaultFlush){let r=[],s=!1;for(let i=this.#e.length-1;i>=0;i--)this.end(this.#e[i].label);for(let[i,{value:a}]of this.#r.entries()){if(this.#t.has(i))continue;r.length===0&&(s=!0,r.push("Hits:"));let o=i.split("//").length;r.push(`${"  ".repeat(o)}${i} ${$(Ae(`\xD7 ${a}`))}`)}this.#t.size>0&&s&&r.push(`
Timers:`);let n=-1/0,l=new Map;for(let[i,{value:a}]of this.#t){let o=`${(Number(a)/1e6).toFixed(2)}ms`;l.set(i,o),n=Math.max(n,o.length)}for(let i of this.#t.keys()){let a=i.split("//").length;r.push(`${$(`[${l.get(i).padStart(n," ")}]`)}${"  ".repeat(a-1)}${a===1?" ":$(" \u21B3 ")}${i.split("//").pop()} ${this.#r.get(i).value===1?"":$(Ae(`\xD7 ${this.#r.get(i).value}`))}`.trimEnd())}t(`
${r.join(`
`)}
`),this.reset()}[Symbol.dispose](){T&&this.report()}};function $(e){return`\x1B[2m${e}\x1B[22m`}function Ae(e){return`\x1B[34m${e}\x1B[39m`}if(!process.versions.bun){let e=b.createRequire(import.meta.url);b.register?.(ut(e.resolve("@tailwindcss/node/esm-cache-loader")))}export{tt as Features,xe as Instrumentation,nt as __unstable__loadDesignSystem,st as compile,rt as compileAst,P as env,L as normalizePath};
